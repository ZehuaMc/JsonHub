# JsonHub
A Dynamic JSON Configuration Management Platform
![Picture](https://image.200502.xyz/i/2025/03/14/yxinjb.webp)
## 系统概述

JSON配置在线分发平台是一个专门用于管理和分发JSON配置文件的Web应用。它提供了一个安全、可靠的环境，用于创建、编辑、版本控制和分发JSON配置文件。

该系统的主要功能包括：

1. **多文件管理**：支持创建和管理多个JSON配置文件
2. **内容替换**：根据预定义的规则动态替换JSON中的特定部分
3. **版本控制**：自动保存历史版本，支持回滚和比较
4. **安全访问**：通过密码或令牌控制访问权限
5. **访问监控**：记录和分析文件访问情况

## 文件结构

```
/
├── index.html           # 主页面
├── config.php           # 配置文件
├── login.php            # 登录处理
├── logout.php           # 登出处理
├── check_auth.php       # 验证登录状态
├── get_files.php        # 获取文件列表
├── get_config.php       # 获取配置文件内容
├── save_config.php      # 保存配置文件
├── upload_config.php    # 上传配置文件
├── json_replacements.php # 替换规则管理
├── history.php          # 历史版本管理
├── raw.php              # 原始JSON访问
├── access_token.php     # 访问令牌管理
├── access_logs.php      # 访问日志
├── dashboard_stats.php  # 仪表盘统计
├── chart_data.php       # 图表数据
├── settings.php         # 系统设置
├── debug.php            # 调试页面
├── json_files/          # JSON文件存储目录
└── history/             # 历史版本存储目录
```

## 安装说明

### 系统要求
- PHP 7.0 或更高版本
- Web服务器（Apache、Nginx等）
- 支持PHP文件写入权限

### 安装步骤

1. 将所有文件上传到您的Web服务器目录
2. 确保以下目录存在并可写：
   - `json_files/` - 用于存储JSON文件
   - `history/` - 用于存储历史版本
3. 确保以下文件存在并可写：
   - `replacements.json` - 替换规则
   - `access_tokens.json` - 访问令牌
   - `access_logs.json` - 访问日志
   - `settings.json` - 系统设置
4. 如果需要，在`config.php`或者`网页设置`中修改密码哈希值（默认密码是 "123456"）

## 功能说明

### 登录系统
访问系统主页，输入密码登录。默认密码是 "123456"。

### 仪表盘
登录后默认进入仪表盘页面，显示系统概览：
- 文件总数
- 替换规则数量
- 历史版本数量
- 访问总次数
- 访问趋势图表

### 文件管理
在"文件"选项卡中，您可以：
1. 查看所有JSON文件列表
2. 创建新的JSON文件
3. 上传现有的JSON文件
4. 编辑文件内容
5. 删除不需要的文件

创建或编辑文件时，系统会自动验证JSON格式的有效性，并提供格式化功能。

### 替换规则
在"替换规则"选项卡中，您可以创建和管理用于动态替换JSON内容的规则：
1. 创建新的替换规则，指定：
   - 规则名称：用于标识规则
   - JSON路径：使用点表示法指定要替换的位置（如 "log" 或 "api.url"）
   - 替换内容：新的JSON内容
2. 编辑现有替换规则
3. 删除不需要的规则

例如，您可以创建一个替换规则，将配置文件中的日志级别从 "info" 更改为 "debug"。

### 历史版本
在"历史版本"选项卡中，您可以管理文件的历史记录：
1. 查看历史版本列表
2. 查看特定历史版本的内容
3. 恢复到历史版本
4. 删除不需要的历史版本

系统会在每次修改文件时自动创建历史版本。

### 访问管理
在"访问管理"选项卡中，您可以生成访问链接：
1. 选择要分发的JSON文件
2. 选择要应用的替换规则（可选）
3. 设置链接有效期（可选）
4. 获取访问密钥

生成的链接包含访问令牌，客户端可以直接通过该链接获取配置文件。

### 访问日志
在"访问日志"选项卡中，您可以查看配置文件的访问记录：
- 访问时间
- IP地址
- 访问的文件
- 应用的替换规则
- 用户代理信息

### 系统设置
在"设置"选项卡中，您可以自定义系统行为：
1. 界面设置：
   - 主题选择（浅色/深色/跟随系统）
   - 编辑器主题
2. 编辑器设置：
   - 自动格式化
   - 行号显示
   - 自动换行
   - 缩进大小
3. 系统设置：
   - 历史版本保留数量
   - 访问日志开关
   - 通知开关

## 客户端访问

客户端可以通过以下方式访问JSON配置文件：

### 使用访问令牌
```
http://your-domain.com/raw.php?file=filename.json&token=your-access-token
```

此方法使用"访问管理"中生成的令牌，支持应用替换规则和设置有效期。

### 应用替换规则
```
http://your-domain.com/raw.php?file=filename.json&token=your-access-token&replace=rule-name
```

通过添加replace参数，可以指定要应用的替换规则。

## 故障排除

如果遇到问题，请尝试以下方法：

1. 访问 `debug.php` 页面，查看系统状态和诊断信息
2. 检查文件和目录权限，确保PHP有写入权限
3. 验证PHP版本是否兼容（需要PHP 7.0+）
4. 检查PHP是否启用了必要的扩展（json、session等）
5. 清除浏览器缓存，或尝试不同的浏览器

如果问题仍然存在，请检查服务器错误日志以获取更多信息。

## 安全建议

1. 更改默认密码
2. 定期清理访问日志和不必要的历史版本
3. 使用HTTPS保护传输安全
4. 对敏感配置使用有限期的访问令牌
5. 定期备份所有配置文件